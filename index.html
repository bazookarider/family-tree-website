<!doctype html><html lang="en"> <head>  <meta charset="UTF-8">  <meta name="viewport" content="width=device-width, initial-scale=1.0">  <title>Benalee Family Tree</title>  <script src="/_sdk/data_sdk.js"></script>  <script src="/_sdk/element_sdk.js"></script>  <style>    body {      box-sizing: border-box;      margin: 0;      padding: 0;      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;      background: linear-gradient(135deg, #006677 0%, #708090 100%);      min-height: 100%;      height: 100%;    }        html {      height: 100%;    }    .container {      max-width: 1400px;      margin: 0 auto;      padding: 20px;    }    .header {      background: white;      padding: 30px;      border-radius: 15px;      box-shadow: 0 8px 20px rgba(0,0,0,0.2);      margin-bottom: 30px;      text-align: center;    }    .header h1 {      margin: 0 0 10px 0;      color: #006677;      font-size: 42px;    }    .header p {      margin: 0;      color: #708090;      font-size: 18px;    }    .controls {      background: white;      padding: 25px;      border-radius: 15px;      box-shadow: 0 8px 20px rgba(0,0,0,0.2);      margin-bottom: 30px;    }    .controls h2 {      margin: 0 0 20px 0;      color: #006677;      font-size: 24px;    }    .button-group {      display: flex;      gap: 15px;      flex-wrap: wrap;      margin-bottom: 20px;    }    .btn {      padding: 12px 24px;      border: none;      border-radius: 8px;      font-size: 16px;      font-weight: 600;      cursor: pointer;      transition: all 0.3s ease;      display: inline-flex;      align-items: center;      gap: 8px;    }    .btn-primary {      background: #006677;      color: white;    }    .btn-primary:hover {      background: #004d5a;      transform: translateY(-2px);      box-shadow: 0 4px 12px rgba(0,102,119,0.3);    }    .btn-secondary {      background: #708090;      color: white;    }    .btn-secondary:hover {      background: #5a6a7a;      transform: translateY(-2px);      box-shadow: 0 4px 12px rgba(112,128,144,0.3);    }    .btn-danger {      background: #dc3545;      color: white;    }    .btn-danger:hover {      background: #c82333;    }    .btn:disabled {      opacity: 0.5;      cursor: not-allowed;      transform: none;    }    .form-group {      margin-bottom: 20px;    }    .form-group label {      display: block;      margin-bottom: 8px;      color: #006677;      font-weight: 600;      font-size: 14px;    }    .form-group input,    .form-group select {      width: 100%;      padding: 12px;      border: 2px solid #e0e0e0;      border-radius: 8px;      font-size: 16px;      transition: border-color 0.3s ease;    }    .form-group input:focus,    .form-group select:focus {      outline: none;      border-color: #006677;    }    .tree-container {      background: white;      padding: 40px;      border-radius: 15px;      box-shadow: 0 8px 20px rgba(0,0,0,0.2);      overflow-x: auto;      min-height: 400px;    }    .tree {      display: flex;      flex-direction: column;      align-items: center;      padding: 20px;    }    .tree-node {      background: linear-gradient(135deg, #006677 0%, #008899 100%);      color: white;      padding: 20px 30px;      border-radius: 12px;      margin: 15px;      box-shadow: 0 4px 12px rgba(0,102,119,0.3);      min-width: 200px;      text-align: center;      position: relative;      transition: all 0.3s ease;    }    .tree-node:hover {      transform: translateY(-5px);      box-shadow: 0 8px 20px rgba(0,102,119,0.4);    }    .tree-node.ancestor {      background: linear-gradient(135deg, #708090 0%, #8a9aa8 100%);      font-size: 20px;      font-weight: bold;      padding: 25px 40px;    }    .tree-node h3 {      margin: 0 0 8px 0;      font-size: 20px;    }    .tree-node p {      margin: 0;      font-size: 14px;      opacity: 0.9;    }    .tree-node-actions {      margin-top: 12px;      display: flex;      gap: 8px;      justify-content: center;    }    .tree-node-actions button {      padding: 6px 12px;      font-size: 12px;    }    .children-container {      display: flex;      flex-wrap: wrap;      justify-content: center;      gap: 20px;      margin-top: 30px;      position: relative;    }    .children-container::before {      content: '';      position: absolute;      top: -30px;      left: 50%;      width: 2px;      height: 30px;      background: #006677;    }    .child-wrapper {      position: relative;    }    .child-wrapper::before {      content: '';      position: absolute;      top: -30px;      left: 50%;      width: 2px;      height: 30px;      background: #006677;    }    .modal {      display: none;      position: fixed;      top: 0;      left: 0;      width: 100%;      height: 100%;      background: rgba(0,0,0,0.7);      z-index: 1000;      align-items: center;      justify-content: center;    }    .modal.active {      display: flex;    }    .modal-content {      background: white;      padding: 30px;      border-radius: 15px;      max-width: 500px;      width: 90%;      max-height: 90%;      overflow-y: auto;    }    .modal-content h2 {      margin: 0 0 20px 0;      color: #006677;    }    .modal-actions {      display: flex;      gap: 10px;      justify-content: flex-end;      margin-top: 20px;    }    .empty-state {      text-align: center;      padding: 60px 20px;      color: #708090;    }    .empty-state h3 {      font-size: 24px;      margin-bottom: 10px;    }    .loading {      display: inline-block;      width: 20px;      height: 20px;      border: 3px solid rgba(255,255,255,0.3);      border-radius: 50%;      border-top-color: white;      animation: spin 1s ease-in-out infinite;    }    @keyframes spin {      to { transform: rotate(360deg); }    }    .hidden {      display: none;    }    input[type="file"] {      display: none;    }    .message {      padding: 15px;      border-radius: 8px;      margin-bottom: 20px;      font-weight: 500;    }    .message.success {      background: #d4edda;      color: #155724;      border: 1px solid #c3e6cb;    }    .message.error {      background: #f8d7da;      color: #721c24;      border: 1px solid #f5c6cb;    }  </style>  <style>@view-transition { navigation: auto; }</style>  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script> </head> <body>  <div class="container">   <div class="header">    <h1 id="tree-title">Benalee Family Tree</h1>    <p id="ancestor-display">Starting with Late Alhaji Ibrahim</p>   </div>   <div class="controls">    <h2>Family Tree Manager</h2>    <div id="message-container"></div>    <div class="button-group"><button class="btn btn-primary" onclick="openAddModal()"> âž• Add Member </button> <button class="btn btn-secondary" onclick="exportData()"> ðŸ“¥ Export JSON </button> <label for="import-file" class="btn btn-secondary"> ðŸ“¤ Import JSON </label> <input type="file" id="import-file" accept=".json" onchange="importData(event)">    </div>   </div>   <div class="tree-container">    <div id="tree" class="tree"></div>   </div>  </div><!-- Add/Edit Modal -->  <div id="member-modal" class="modal">   <div class="modal-content">    <h2 id="modal-title">Add Family Member</h2>    <form id="member-form" onsubmit="saveMember(event)">     <div class="form-group"><label for="member-name">Name *</label> <input type="text" id="member-name" required placeholder="Enter member name">     </div>     <div class="form-group"><label for="member-role">Role/Relationship *</label> <input type="text" id="member-role" required placeholder="e.g., Son, Daughter, Wife">     </div>     <div class="form-group"><label for="member-parent">Parent</label> <select id="member-parent"> <option value="">None (Root Ancestor)</option> </select>     </div>     <div class="modal-actions"><button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button> <button type="submit" class="btn btn-primary" id="save-btn"> <span id="save-text">Save</span> </button>     </div>    </form>   </div>  </div>  <script>    let members = [];    let editingMember = null;    const defaultConfig = {      tree_title: "Benalee Family Tree",      ancestor_name: "Late Alhaji Ibrahim",      primary_color: "#006677",      secondary_color: "#708090"    };    // Data SDK Handler    const dataHandler = {      onDataChanged(data) {        members = data;        renderTree();        updateParentDropdown();      }    };    // Initialize SDKs    async function initApp() {      const dataResult = await window.dataSdk.init(dataHandler);      if (!dataResult.isOk) {        showMessage('Failed to initialize data storage', 'error');        console.error('Data SDK init failed');      }      if (window.elementSdk) {        window.elementSdk.init({          defaultConfig,          onConfigChange: async (config) => {            document.getElementById('tree-title').textContent = config.tree_title || defaultConfig.tree_title;            document.getElementById('ancestor-display').textContent = `Starting with ${config.ancestor_name || defaultConfig.ancestor_name}`;                        const primaryColor = config.primary_color || defaultConfig.primary_color;            const secondaryColor = config.secondary_color || defaultConfig.secondary_color;                        document.body.style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%)`;            document.querySelector('.header h1').style.color = primaryColor;                        const primaryButtons = document.querySelectorAll('.btn-primary');            primaryButtons.forEach(btn => {              btn.style.background = primaryColor;            });                        const secondaryButtons = document.querySelectorAll('.btn-secondary');            secondaryButtons.forEach(btn => {              btn.style.background = secondaryColor;            });          },          mapToCapabilities: (config) => ({            recolorables: [              {                get: () => config.primary_color || defaultConfig.primary_color,                set: (value) => {                  window.elementSdk.config.primary_color = value;                  window.elementSdk.setConfig({ primary_color: value });                }              },              {                get: () => config.secondary_color || defaultConfig.secondary_color,                set: (value) => {                  window.elementSdk.config.secondary_color = value;                  window.elementSdk.setConfig({ secondary_color: value });                }              }            ],            borderables: [],            fontEditable: undefined,            fontSizeable: undefined          }),          mapToEditPanelValues: (config) => new Map([            ["tree_title", config.tree_title || defaultConfig.tree_title],            ["ancestor_name", config.ancestor_name || defaultConfig.ancestor_name]          ])        });      }    }    function showMessage(text, type = 'success') {      const container = document.getElementById('message-container');      const message = document.createElement('div');      message.className = `message ${type}`;      message.textContent = text;      container.appendChild(message);            setTimeout(() => {        message.remove();      }, 5000);    }    function renderTree() {      const treeContainer = document.getElementById('tree');            if (members.length === 0) {        treeContainer.innerHTML = `          <div class="empty-state">            <h3>No Family Members Yet</h3>            <p>Click "Add Member" to start building your family tree</p>          </div>        `;        return;      }      const rootMembers = members.filter(m => !m.parentId || m.parentId === '');            treeContainer.innerHTML = '';      rootMembers.forEach(root => {        treeContainer.appendChild(createTreeNode(root));      });    }    function createTreeNode(member) {      const node = document.createElement('div');      const isAncestor = !member.parentId || member.parentId === '';            node.className = `tree-node ${isAncestor ? 'ancestor' : ''}`;      node.innerHTML = `        <h3>${member.name}</h3>        <p>${member.role}</p>        <div class="tree-node-actions">          <button class="btn btn-primary" onclick="editMember('${member.__backendId}')">Edit</button>          <button class="btn btn-danger" onclick="deleteMember('${member.__backendId}')">Delete</button>        </div>      `;      const children = members.filter(m => m.parentId === member.id);      if (children.length > 0) {        const childrenContainer = document.createElement('div');        childrenContainer.className = 'children-container';                children.forEach(child => {          const childWrapper = document.createElement('div');          childWrapper.className = 'child-wrapper';          childWrapper.appendChild(createTreeNode(child));          childrenContainer.appendChild(childWrapper);        });                node.appendChild(childrenContainer);      }      return node;    }    function updateParentDropdown() {      const select = document.getElementById('member-parent');      const currentValue = select.value;            select.innerHTML = '<option value="">None (Root Ancestor)</option>';            members.forEach(member => {        if (!editingMember || member.__backendId !== editingMember.__backendId) {          const option = document.createElement('option');          option.value = member.id;          option.textContent = `${member.name} (${member.role})`;          select.appendChild(option);        }      });            select.value = currentValue;    }    function openAddModal() {      editingMember = null;      document.getElementById('modal-title').textContent = 'Add Family Member';      document.getElementById('member-form').reset();      document.getElementById('member-modal').classList.add('active');      updateParentDropdown();    }    function editMember(backendId) {      editingMember = members.find(m => m.__backendId === backendId);      if (!editingMember) return;      document.getElementById('modal-title').textContent = 'Edit Family Member';      document.getElementById('member-name').value = editingMember.name;      document.getElementById('member-role').value = editingMember.role;      document.getElementById('member-parent').value = editingMember.parentId || '';      document.getElementById('member-modal').classList.add('active');      updateParentDropdown();    }    async function saveMember(event) {      event.preventDefault();            const saveBtn = document.getElementById('save-btn');      const saveText = document.getElementById('save-text');      saveBtn.disabled = true;      saveText.innerHTML = '<span class="loading"></span>';      const name = document.getElementById('member-name').value;      const role = document.getElementById('member-role').value;      const parentId = document.getElementById('member-parent').value;      if (editingMember) {        const updatedMember = {          ...editingMember,          name,          role,          parentId        };                const result = await window.dataSdk.update(updatedMember);                if (result.isOk) {          showMessage('Member updated successfully!', 'success');          closeModal();        } else {          showMessage('Failed to update member', 'error');        }      } else {        if (members.length >= 999) {          showMessage('Maximum limit of 999 members reached', 'error');          saveBtn.disabled = false;          saveText.textContent = 'Save';          return;        }        const newMember = {          id: Date.now().toString(),          name,          role,          parentId,          createdAt: new Date().toISOString()        };        const result = await window.dataSdk.create(newMember);                if (result.isOk) {          showMessage('Member added successfully!', 'success');          closeModal();        } else {          showMessage('Failed to add member', 'error');        }      }      saveBtn.disabled = false;      saveText.textContent = 'Save';    }    async function deleteMember(backendId) {      const member = members.find(m => m.__backendId === backendId);      if (!member) return;      const hasChildren = members.some(m => m.parentId === member.id);      if (hasChildren) {        showMessage('Cannot delete member with children. Delete children first.', 'error');        return;      }      const result = await window.dataSdk.delete(member);            if (result.isOk) {        showMessage('Member deleted successfully!', 'success');      } else {        showMessage('Failed to delete member', 'error');      }    }    function closeModal() {      document.getElementById('member-modal').classList.remove('active');      document.getElementById('member-form').reset();      editingMember = null;    }    function exportData() {      const exportData = members.map(({ __backendId, ...rest }) => rest);      const dataStr = JSON.stringify(exportData, null, 2);      const dataBlob = new Blob([dataStr], { type: 'application/json' });      const url = URL.createObjectURL(dataBlob);      const link = document.createElement('a');      link.href = url;      link.download = 'benalee-family-tree.json';      link.click();      URL.revokeObjectURL(url);      showMessage('Family tree exported successfully!', 'success');    }    async function importData(event) {      const file = event.target.files[0];      if (!file) return;      const reader = new FileReader();      reader.onload = async (e) => {        try {          const importedData = JSON.parse(e.target.result);                    if (!Array.isArray(importedData)) {            showMessage('Invalid JSON format', 'error');            return;          }          for (const member of importedData) {            if (members.length >= 999) {              showMessage('Import stopped: Maximum limit of 999 members reached', 'error');              break;            }            const exists = members.some(m => m.id === member.id);            if (!exists) {              await window.dataSdk.create(member);            }          }          showMessage('Family tree imported successfully!', 'success');        } catch (error) {          showMessage('Failed to import JSON file', 'error');        }      };      reader.readAsText(file);      event.target.value = '';    }    // Initialize app    initApp();  </script> <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99c59b2cf547989c',t:'MTc2Mjc3ODI5OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body></html>