:root{
  --main:#006677;
  --accent:#0099aa;
  --bg:#f8f9fa;
  --card-bg:#fff;
  --muted:#666;
}
*{box-sizing:border-box}
body{
  font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  margin:0;
  background:var(--bg);
  color:#222;
  -webkit-font-smoothing:antialiased;
  padding-bottom:220px; 
}
header{
  background:linear-gradient(90deg,var(--main),var(--accent));
  color:#fff;
  padding:18px 12px;
  text-align:center;
  box-shadow:0 10px 30px rgba(0,0,0,0.14);
}
header h1{margin:0;letter-spacing:2px}
header p{margin:6px 0 0;opacity:.95;font-size:14px}

.main-layout-wrapper {
  display: flex;
  width: min(1200px, 98%);
  margin: 12px auto 24px;
  gap: 16px; 
}
.main-content {
  flex: 1;
  min-width: 0; 
}
.events-panel {
  width: 280px; 
  background: var(--card-bg);
  border-radius: 12px;
  box-shadow: 0 8px 18px rgba(0,0,0,0.08);
  border: 1px solid rgba(0,0,0,0.04);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  height: fit-content; 
}
.events-header {
  background: #ffaa33; 
  color: #fff;
  padding: 8px 12px;
  font-weight: 600;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.events-body {
  flex: 1;
  padding: 10px;
  overflow-y: auto;
  min-height: 100px;
}
.events-footer {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 10px;
  border-top: 1px solid #eee;
  background: #fff;
}
.events-footer input, .events-footer textarea {
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid #ddd;
  font-size: 14px;
  width: 100%;
}
.event-item {
  margin-bottom: 12px;
  padding: 10px;
  border-radius: 8px;
  background: #fff8e8; 
  border-left: 4px solid #ffaa33;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  position: relative;
}
.event-title {
  font-weight: 700;
  color: #cc6600;
  margin-bottom: 4px;
}
.event-date {
  font-style: italic;
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 6px;
}
.event-details {
  font-size: 14px;
}
.event-delete-btn {
    position: absolute;
    top: 6px;
    right: 6px;
    background: transparent;
    border: none;
    cursor: pointer;
    font-size: 16px;
    color: #cc0000;
    opacity: 0.7;
}

.controls{
  width:min(1100px,96%);
  margin:14px auto;
  display:flex;
  gap:12px;
  align-items:center;
  justify-content:space-between;
  flex-wrap:wrap;
}
.form{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.form input, .form select, .form textarea {
  padding:8px 10px;border-radius:8px;border:1px solid #d0d7d7;font-size:14px;
}
.form button, .form label{background:var(--main);color:#fff;border:none;padding:9px 14px;border-radius:10px;cursor:pointer}

.admin-btns {
  position:absolute; bottom:8px; left:8px; display:flex; gap:4px;
}
.admin-btns button {
  border: none;
  padding: 4px 6px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  color: #fff;
}

.hint{font-size:13px;color:var(--muted)}
.tree-wrap{
  width:100%;
  margin:12px auto 24px;
  padding:10px;
  overflow:auto;
  position:relative;
  background:transparent;
  border-radius:8px;
}

#connections {
  position:absolute;
  left:0;top:0;
  pointer-events:none;
  width:100%;height:100%;
  overflow:visible;
}

.tree {
  display:flex;
  justify-content:center;
  padding: 20px 10px 60px;
  min-width:700px; 
}
.tree ul { padding-top: 28px; position: relative; display:inline-block; text-align:center; white-space: nowrap; }
.tree li {
  display:inline-block; vertical-align:top; text-align:center; margin:0 16px; padding:0 6px 0 6px; position:relative;
}

.tree ul::before {
  content: ''; position: absolute; top: 0; left: 50%;
  border-left: 2px solid rgba(0,0,0,0.07); height: 18px; transform: translateX(-50%);
}
.tree li::before, .tree li::after {
  content:''; position:absolute; top:18px; width:12px; height:2px; border-top:2px solid rgba(0,0,0,0.07);
}
.tree li::before{ right:50% } .tree li::after{ left:50% }
.tree li:only-child::before, .tree li:only-child::after { display:none; }
.tree li:first-child::before{ display:none } .tree li:last-child::after{ display:none }

.card {
  background:var(--card-bg); border-radius:12px; padding:12px 14px; width:200px;
  box-shadow:0 8px 18px rgba(0,0,0,0.08); border:2px solid rgba(0,0,0,0.04);
  cursor:pointer; transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease;
  position:relative;
}
.card:hover{ transform:translateY(-6px); box-shadow:0 14px 28px rgba(0,0,0,0.12) }
.name{ color:var(--main); font-weight:700; margin-bottom:4px; }
.role{ color:var(--muted); font-size:13px; margin-bottom:6px; }
.nick{ font-style:italic; color:#444; font-size:13px }

.card.selected { border-color: var(--accent); box-shadow:0 0 18px rgba(0,153,170,0.12) }
.card.child-highlight { box-shadow:0 0 20px rgba(0,153,170,0.18) !important; border-color:var(--accent) !important }

.toggle-btn {
  position:absolute; right:8px; top:8px; width:26px; height:26px; border-radius:6px; border:none;
  background:var(--main); color:#fff; font-weight:700; cursor:pointer; font-size:16px; display:flex;align-items:center;justify-content:center;
}
.collapsed > ul { display:none; }

.chat-panel {
  position:fixed; left:12px; right:12px; bottom:12px; max-width:1200px; margin:0 auto;
  background:#fff; border-radius:12px; box-shadow:0 18px 40px rgba(0,0,0,0.18); overflow:hidden;
  display:flex; flex-direction:column; height:200px;
}
.chat-header { background:var(--main); color:#fff; padding:8px 12px; font-weight:600; display:flex;justify-content:space-between;align-items:center;}
.chat-body { flex:1; padding:10px; overflow:auto; background:#fbfdfd; }
.chat-footer { display:flex; gap:8px; padding:10px; border-top:1px solid #eee; background:#fff; }
.chat-footer input, .chat-footer select { padding:8px 10px; border-radius:8px; border:1px solid #ddd; font-size:14px; }
.chat-footer button { background:var(--main); color:#fff; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; }

.message { margin-bottom:8px; padding:6px 8px; border-radius:8px; background:#fff; box-shadow:0 2px 6px rgba(0,0,0,0.04); }
.message .meta { font-size:12px; color:var(--muted); margin-bottom:4px; }
.message .text { font-size:14px; color:#222; }

/* responsive tweaks */
@media (max-width:900px){
  .main-layout-wrapper {
      flex-direction: column; 
  }
  .events-panel {
      width: 100%; 
  }
}
@media (max-width:820px){
  .tree { min-width:900px; } 
  .controls{flex-direction:column;align-items:flex-start}
  .form input{width:120px}
  .chat-panel{left:8px;right:8px}
}
@media (max-width:480px){
  .card{width:150px}
}
